<header class="header">
  <div class="header-container">
    <div class="logo">
      <a routerLink="/" (click)="cerrarMenu()">
        <img src="/images/LOGOSUBLISA.png" alt="Sublisa Logo" class="logo-image">
      </a>
    </div>

    <button (click)="carritoService.abrirCarrito()" class="carrito-mobile">
      ğŸ›’
      @if (carritoService.cantidadTotal() > 0) {
        <span class="badge-mobile">{{ carritoService.cantidadTotal() }}</span>
      }
    </button>

    <button class="menu-toggle" (click)="toggleMenu()" [class.active]="menuAbierto">
      <span></span>
      <span></span>
      <span></span>
    </button>

    <nav class="nav" [class.open]="menuAbierto">
      <div class="nav-item-dropdown"
           (mouseenter)="menuProductosAbierto.set(true)"
           (mouseleave)="cerrarMenuProductos()">
        <a routerLink="/"
           routerLinkActive="active"
           [routerLinkActiveOptions]="{exact: true}"
           (click)="toggleMenuProductos(); $event.preventDefault()"
           class="nav-link productos-link">
          Productos â–¾
        </a>
        <div class="dropdown-menu" [class.show]="menuProductosAbierto()">
          @for (categoria of categorias(); track categoria) {
            <a [routerLink]="['/']"
               [queryParams]="{categoria: categoria}"
               (click)="cerrarMenu()"
               class="dropdown-item">
              {{ categoria }}
            </a>
          }
        </div>
      </div>

      <a routerLink="/quienes-somos" routerLinkActive="active" (click)="cerrarMenu()" class="nav-link">
        QuiÃ©nes Somos
      </a>

      <a routerLink="/como-comprar" routerLinkActive="active" (click)="cerrarMenu()" class="nav-link">
        CÃ³mo Comprar
      </a>

      <button (click)="carritoService.toggleCarrito(); cerrarMenu()" class="nav-link carrito-link carrito-btn">
        ğŸ›’ Carrito
        @if (carritoService.cantidadTotal() > 0) {
          <span class="badge">{{ carritoService.cantidadTotal() }}</span>
        }
      </button>

      <!-- Mostrar segÃºn estado de autenticaciÃ³n y rol -->
      @if (authService.isAuthenticatedSignal$()()) {
        @if (authService.isAdmin()) {
          <a routerLink="/admin/dashboard" routerLinkActive="active" (click)="cerrarMenu()" class="nav-link admin-link">
            ğŸ” Admin
          </a>
        } @else {
          <a routerLink="/mi-cuenta" routerLinkActive="active" (click)="cerrarMenu()" class="nav-link cuenta-link">
            ğŸ‘¤ Mi Cuenta
          </a>
        }
        <button (click)="logout()" class="nav-link logout-btn">
          ğŸšª Cerrar SesiÃ³n
        </button>
      } @else {
        <a routerLink="/login" routerLinkActive="active" (click)="cerrarMenu()" class="nav-link login-link">
          ğŸ”‘ Iniciar SesiÃ³n
        </a>
      }
    </nav>
  </div>
</header>
